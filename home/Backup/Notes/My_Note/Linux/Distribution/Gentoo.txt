Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2011-11-02T14:27:38+08:00

====== Gentoo ======

[[+liveusb|liveusb]], [[+portage|portage]],

升级步骤：
$ sudo emerge --sync
$ sudo /usr/lib/portage/bin/fixpackgges					#Performing Global Updates
$ sudo emerge --keep-going -avuDN --with-bdeps y world
$ sudo revdep-rebuild 							#app-portage/gentoolkit 包的一个工具。
$ sudo python-updater
$ sudo perl-cleaner all

$ sudo emerge -av --depclean						#去掉多余的包
$ sudo revdep-rebuild							#重建链接
$ sudo dispatch-conf							#更新配置文件
$ sudo emerge -C gnome && emerge --depclean && revdep-rebuild		卸载gnome 

# Kernel upgrade
emerge --sync
emerge -u gentoo-sources
eselect kernel list
eselect kernel set 
make && make modules_install
....
module-rebuild rebuild

#rm the older kernel
emerge -P gentoo-sources
rm -r /usr/src/linux-2......
rm -r /lib/modules/2.6......

# GCC upgrade
emerge -uav gcc
gcc-config x86_64-pc-linux-gnu-4.5.1
env-update && source /etc/profile
emerge --oneshot -av libtool
/usr/share/gcc-date/$CHOST/<gcc-version>/fix_libtool_files.sh 4.5.1

revdep-rebuild
or
revdep-rebuild --library libstdc++.so.5 -- -p -v
revdep-rebuild --library libstdc++.so.5
or
emerge -eav system
emerge -eav world

#removing older gcc
emerge -aC =sys-devel/gcc-4.4*

# Restoring promary specs
gcc-config 1
source /etc/profile
unset GCC_SPECS
emerge -uav gcc

#常用命令
$ sudo python-updater
$ sudo perl-cleaner
$ euse -i useflag							#查看useflag具体作用
$ e-file file								#查看文件所属包，需要pfl包
# module-rebuild list							#列出外部模块
$ equery b pkg								#查询pkg被哪个包依赖
$ equery d pkg								#查询那些包依赖pkg
$qlist -Iv								#portage-utils工具，查看已安装的包
equery d name | xargs emerge -C						#卸载软件包name及其所有被依赖的包
# eix-sync				#emerge --sync && eix-update && eix-diff
